<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Shopping List</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Fallback styles if Tailwind doesn't load */
        body { font-family: system-ui, -apple-system, sans-serif; margin: 0; padding: 0; background-color: #f9fafb; }
        .container { max-width: 1200px; margin: 0 auto; padding: 1rem; }
        .card { background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 1rem; margin-bottom: 1rem; }
        .btn { padding: 0.5rem 1rem; border-radius: 4px; border: none; cursor: pointer; font-size: 0.875rem; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-danger { background: #dc2626; color: white; }
        .btn-danger:hover { background: #b91c1c; }
        input, select { padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 4px; font-size: 0.875rem; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.5rem; text-align: left; border-bottom: 1px solid #e5e7eb; }
        th { background: #f9fafb; font-weight: 600; cursor: pointer; }
        .priority-high { background: #fee2e2; color: #991b1b; }
        .priority-med { background: #fef3c7; color: #92400e; }
        .priority-low { background: #dcfce7; color: #166534; }
        .purchased { opacity: 0.6; text-decoration: line-through; }
    </style>
</head>
<body>
    <div id="root">
        <div style="padding: 20px; text-align: center;">
            <p>Loading...</p>
            <p style="font-size: 12px; color: #666;">If this doesn't load, try opening Developer Tools (F12) to see any errors.</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // Simple icons as text/symbols
        const PlusIcon = () => "+";
        const TrashIcon = () => "ðŸ—‘";
        const SortUpIcon = () => "â†‘";
        const SortDownIcon = () => "â†“";

        const ShoppingListApp = () => {
          // Load data from localStorage on startup
          const [items, setItems] = useState(() => {
            try {
              const saved = localStorage.getItem('shoppingListItems');
              return saved ? JSON.parse(saved) : [
                { id: 1, item: 'Milk', priority: 4, category: 'fridge', purchased: false },
                { id: 2, item: 'Bread', priority: 3, category: 'long expiration', purchased: false },
                { id: 3, item: 'Ice Cream', priority: 5, category: 'freezer', purchased: false },
                { id: 4, item: 'T-Shirt', priority: 2, category: 'clothes', purchased: false },
                { id: 5, item: 'Chicken Breast', priority: 4, category: 'freezer', purchased: false },
                { id: 6, item: 'Pasta', priority: 3, category: 'long expiration', purchased: false },
              ];
            } catch (e) {
              console.error('Error loading from localStorage:', e);
              return [
                { id: 1, item: 'Milk', priority: 4, category: 'fridge', purchased: false },
                { id: 2, item: 'Bread', priority: 3, category: 'long expiration', purchased: false },
              ];
            }
          });

          // Save to localStorage whenever items change
          useEffect(() => {
            try {
              localStorage.setItem('shoppingListItems', JSON.stringify(items));
            } catch (e) {
              console.error('Error saving to localStorage:', e);
            }
          }, [items]);

          const [newItem, setNewItem] = useState({ item: '', priority: 3, category: 'fridge' });
          const [filters, setFilters] = useState({
            priority: [],
            category: '',
            hidePurchased: true
          });
          const [sortConfig, setSortConfig] = useState({ key: 'priority', direction: 'desc' });

          const categories = ['fridge', 'freezer', 'long expiration', 'clothes'];
          const categoryShortNames = {
            'fridge': 'F',
            'freezer': 'Z',
            'long expiration': 'LE',
            'clothes': 'C'
          };
          const priorities = [1, 2, 3, 4, 5];

          const addItem = () => {
            if (newItem.item.trim()) {
              setItems([...items, {
                id: Date.now(),
                ...newItem,
                purchased: false
              }]);
              setNewItem({ item: '', priority: 3, category: 'fridge' });
            }
          };

          const togglePurchased = (id) => {
            setItems(items.map(item => 
              item.id === id ? { ...item, purchased: !item.purchased } : item
            ));
          };

          const deleteItem = (id) => {
            if (confirm('Delete this item?')) {
              setItems(items.filter(item => item.id !== id));
            }
          };

          const handleSort = (key) => {
            let direction = 'asc';
            if (sortConfig.key === key && sortConfig.direction === 'asc') {
              direction = 'desc';
            }
            setSortConfig({ key, direction });
          };

          const togglePriorityFilter = (priority) => {
            setFilters(prev => ({
              ...prev,
              priority: prev.priority.includes(priority)
                ? prev.priority.filter(p => p !== priority)
                : [...prev.priority, priority]
            }));
          };

          const filteredAndSortedItems = useMemo(() => {
            let filtered = items.filter(item => {
              if (filters.hidePurchased && item.purchased) return false;
              if (filters.priority.length > 0 && !filters.priority.includes(item.priority)) {
                return false;
              }
              if (filters.category && item.category !== filters.category) {
                return false;
              }
              return true;
            });

            filtered.sort((a, b) => {
              let aVal = a[sortConfig.key];
              let bVal = b[sortConfig.key];
              
              if (typeof aVal === 'string') {
                aVal = aVal.toLowerCase();
                bVal = bVal.toLowerCase();
              }
              
              if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;
              if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;
              return 0;
            });

            return filtered;
          }, [items, filters, sortConfig]);

          const getSortIcon = (columnKey) => {
            if (sortConfig.key !== columnKey) return React.createElement('span', { style: { color: '#9ca3af' } }, 'â†•');
            return sortConfig.direction === 'asc' 
              ? React.createElement(SortUpIcon, { style: { color: '#2563eb' } })
              : React.createElement(SortDownIcon, { style: { color: '#2563eb' } });
          };

          const getPriorityClass = (priority) => {
            if (priority >= 4) return 'priority-high';
            if (priority === 3) return 'priority-med';
            return 'priority-low';
          };

          return React.createElement('div', { className: 'container' },
            React.createElement('h1', { style: { fontSize: '1.5rem', fontWeight: 'bold', marginBottom: '1rem' } }, 'Smart Shopping List'),
            
            // Add New Item
            React.createElement('div', { className: 'card' },
              React.createElement('h2', { style: { fontSize: '1rem', fontWeight: '600', marginBottom: '0.5rem' } }, 'Add New Item'),
              React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '0.5rem', alignItems: 'end' } },
                React.createElement('input', {
                  type: 'text',
                  placeholder: 'Item name',
                  value: newItem.item,
                  onChange: (e) => setNewItem({...newItem, item: e.target.value}),
                  onKeyPress: (e) => e.key === 'Enter' && addItem()
                }),
                React.createElement('select', {
                  value: newItem.priority,
                  onChange: (e) => setNewItem({...newItem, priority: parseInt(e.target.value)})
                }, priorities.map(p => 
                  React.createElement('option', { key: p, value: p }, `Priority ${p}`)
                )),
                React.createElement('select', {
                  value: newItem.category,
                  onChange: (e) => setNewItem({...newItem, category: e.target.value})
                }, categories.map(cat => 
                  React.createElement('option', { key: cat, value: cat }, `${categoryShortNames[cat]} - ${cat}`)
                )),
                React.createElement('button', {
                  onClick: addItem,
                  className: 'btn btn-primary'
                }, '+ Add')
              )
            ),

            // Filters
            React.createElement('div', { className: 'card' },
              React.createElement('h3', { style: { fontSize: '1rem', fontWeight: '600', marginBottom: '0.5rem' } }, 'Filters'),
              React.createElement('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' } },
                React.createElement('div', null,
                  React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.25rem' } }, 'Priority'),
                  React.createElement('div', { style: { display: 'flex', gap: '0.25rem', flexWrap: 'wrap' } },
                    priorities.map(priority => 
                      React.createElement('button', {
                        key: priority,
                        onClick: () => togglePriorityFilter(priority),
                        style: {
                          padding: '0.25rem 0.5rem',
                          borderRadius: '4px',
                          border: 'none',
                          fontSize: '0.75rem',
                          cursor: 'pointer',
                          backgroundColor: filters.priority.includes(priority) ? '#2563eb' : '#e5e7eb',
                          color: filters.priority.includes(priority) ? 'white' : '#374151'
                        }
                      }, priority)
                    )
                  )
                ),
                React.createElement('div', null,
                  React.createElement('label', { style: { display: 'block', fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.25rem' } }, 'Category'),
                  React.createElement('select', {
                    value: filters.category,
                    onChange: (e) => setFilters({...filters, category: e.target.value}),
                    style: { width: '100%' }
                  }, 
                    React.createElement('option', { value: '' }, 'All'),
                    categories.map(cat => 
                      React.createElement('option', { key: cat, value: cat }, `${categoryShortNames[cat]} - ${cat}`)
                    )
                  )
                ),
                React.createElement('div', null,
                  React.createElement('label', { style: { display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' } },
                    React.createElement('input', {
                      type: 'checkbox',
                      checked: filters.hidePurchased,
                      onChange: (e) => setFilters({...filters, hidePurchased: e.target.checked})
                    }),
                    React.createElement('span', { style: { fontSize: '0.875rem' } }, 'Hide purchased')
                  )
                )
              ),
              React.createElement('button', {
                onClick: () => setFilters({ priority: [], category: '', hidePurchased: true }),
                style: { marginTop: '0.5rem', color: '#2563eb', background: 'none', border: 'none', fontSize: '0.875rem', cursor: 'pointer' }
              }, 'Clear filters')
            ),

            // Table
            React.createElement('div', { className: 'card', style: { overflowX: 'auto' } },
              React.createElement('table', null,
                React.createElement('thead', null,
                  React.createElement('tr', null,
                    React.createElement('th', {
                      onClick: () => handleSort('item'),
                      style: { cursor: 'pointer' }
                    }, 'Item ', getSortIcon('item')),
                    React.createElement('th', {
                      onClick: () => handleSort('priority'),
                      style: { cursor: 'pointer', textAlign: 'center' }
                    }, 'Priority ', getSortIcon('priority')),
                    React.createElement('th', {
                      onClick: () => handleSort('category'),
                      style: { cursor: 'pointer', textAlign: 'center' }
                    }, 'Category ', getSortIcon('category')),
                    React.createElement('th', { style: { textAlign: 'center' } }, 'Done'),
                    React.createElement('th', { style: { textAlign: 'center' } }, 'Delete')
                  )
                ),
                React.createElement('tbody', null,
                  filteredAndSortedItems.map((item) =>
                    React.createElement('tr', { 
                      key: item.id,
                      className: item.purchased ? 'purchased' : '',
                      style: { backgroundColor: item.purchased ? '#f9fafb' : 'white' }
                    },
                      React.createElement('td', null, item.item),
                      React.createElement('td', { style: { textAlign: 'center' } },
                        React.createElement('span', {
                          className: getPriorityClass(item.priority),
                          style: { 
                            padding: '0.25rem 0.5rem', 
                            borderRadius: '12px', 
                            fontSize: '0.75rem',
                            fontWeight: 'bold'
                          }
                        }, item.priority)
                      ),
                      React.createElement('td', { style: { textAlign: 'center' } }, categoryShortNames[item.category]),
                      React.createElement('td', { style: { textAlign: 'center' } },
                        React.createElement('input', {
                          type: 'checkbox',
                          checked: item.purchased,
                          onChange: () => togglePurchased(item.id)
                        })
                      ),
                      React.createElement('td', { style: { textAlign: 'center' } },
                        React.createElement('button', {
                          onClick: () => deleteItem(item.id),
                          className: 'btn-danger',
                          style: { padding: '0.25rem 0.5rem', fontSize: '0.75rem' }
                        }, 'ðŸ—‘')
                      )
                    )
                  )
                )
              ),
              filteredAndSortedItems.length === 0 && 
                React.createElement('div', { style: { textAlign: 'center', padding: '2rem', color: '#6b7280' } },
                  React.createElement('p', null, 'No items match your current filters'),
                  React.createElement('p', { style: { fontSize: '0.875rem' } }, 'Try adjusting your filters or add new items')
                )
            ),

            // Summary
            React.createElement('div', { className: 'card' },
              React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', fontSize: '0.875rem', color: '#6b7280' } },
                React.createElement('span', null, `Total: ${items.length}`),
                React.createElement('span', null, `Showing: ${filteredAndSortedItems.length}`),
                React.createElement('span', null, `Purchased: ${items.filter(item => item.purchased).length}`)
              )
            )
          );
        };

        // Render the app
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot ? ReactDOM.createRoot(container) : null;
        
        if (root) {
          root.render(React.createElement(ShoppingListApp));
        } else {
          ReactDOM.render(React.createElement(ShoppingListApp), container);
        }
    </script>
</body>
</html>
